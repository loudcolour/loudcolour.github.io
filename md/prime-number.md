<!---
title: '소수'
category: Mathematics
language: Korean
--->

# 소수

**소수**는 $1$과 자신 외의 자연수로 나누어 떨어지지 않는 수이다.
또한, 2개 이상의 소수의 곱으로 나타내어지는 수를 **합성수**라고 한다.
예를 들어, $17$은 소수이다. $54$는 합성수이다.
편의상, 이 노트에서는 양의 소수만을 소수라고 할 것이다. 약수 또한 양의 약수를 의미한다.

**명제**. $\forall n\in\N, n\geq 2$의 $1$을 제외한 약수 중, 최소의 것은 소수이다.

*증명*. 위에서 언급한 $1$을 제외한 최소의 약수를 $p$라고 하자.
$p\mid n$이므로, $\exists m\in\N, n=mp$이다.
그런데 $p$가 소수가 아니라고 하면 $\exists a,b\in\N, (1<a,b<p) \land (p=ab)$이고,
$n = abm$이다. 따라서 $a\mid n$이고, $p$가 최소의 $1$이 아닌 약수라는 조건에 모순이므로
$p$는 소수이다. □

위 명제에 따르면, 어떤 $1$이상의 자연수 $n$이 주어졌을 때,
$n$의 $1$이 아닌 약수 중 최소의 것인 $p_1$이 존재할 것이고,
$\frac{n}{p_1}\in\N$이므로, 다시 $1$이 아닌 약수 중 최소의 것을 $p_2$로
잡아, 이러한 연산을 계속하여 반복하는 것이 가능할 것이다.
이 연산이 성립하지 않을 때까지의 결과를 늘어 놓으면

$$
n > \frac{n}{p_1} > \frac{n}{p_1p_2}> \frac{n}{p_1p_2p_3} \cdots
$$

와 같을 것이고, 위는 단조 감소의 자연수열이므로 결국에는 $\frac{n}{p_1p_2\cdots p_r}=1$인
$r\in\N$이 존재한다는 사실을 알 수 있다.
따라서 모든 $2$이상의 자연수는 소수 혹은 소수의 곱으로 표현하는 것이 가능하며,
더 나아가 소수와 합성수 중 하나에 해당함을 알 수 있다.
이 때, $n=p_1p_2\cdots p_r$과 같이 소수의 곱의 형식으로 표현한것을 **소인수분해**라고 한다.

## 소수는 무한히 존재한다

가장 작은 소수인 $2$부터, 오름차순으로 소수들을
$2, 3, 5, 7, 11,\ldots$와 같이 나열할 수 있다.
그리고 이 수열은 끝나지 않는다. 소수는 무한히 존재하기 때문이다.

**정리**. 소수는 무한히 존재한다.

*증명*(Euclid의 증명). 소수가 총 $N$개 존재하여 유한하다고 가정하고, 최소의 소수부터
최대의 소수가 오름차순이 되도록 나열한 것을 $p_1, p_2, \ldots, p_N$이라고 하자.
$P:=p_1p_2\cdots p_N+1$으로 두면, $P$는 소수가 아니므로 합성수일 것이고,
$p_i\mid P$인 $i\in\{1,2,\ldots,N\}$이 존재할 것이다. 따라서
$p_i | 1 = P - p_1p_2\cdots p_N$여야 하나, 이를 만족하는 소수는 만족하지 않으므로 모순이다.
따라서 소수는 무한히 존재한다. □

*증명*(Euler의 증명).
크기 오름차순으로 소수를 나열했을 때, $n$번째의 소수를 $p_n$으로 두자.
$p_n\geq2$이므로, $s>1$에 대해 $0<p_n^{-s}<1$이다. 따라서

$$
\begin{aligned}
\left(1-p_n^{-s}\right)^{-1} &= \sum_{j=0}^{\infty}p_n^{-js} \\
\prod_{n=1}^{N}\left(1-p_n^{-s}\right)^{-1} &=
\left(\sum_{j_1=0}^{\infty}p_1^{-j_1s}\right)
\cdots
\left(\sum_{j_N=0}^{\infty}p_N^{-j_Ns}\right) \\
&=\sum_{\left(j_1,\ldots,j_N\right)\in\N^{N}}
\left(p_1^{j_1}\cdots p_N^{j_N}\right)^{-s}
\end{aligned}
$$

모든 자연수는 각자의 소인수분해에 일의적으로 대응한다는 사실을 통해, 위 식에서

$$
\prod_{n=1}^{N}\left(1-p_n^{-s}\right)^{-1} = \sum_{n=1}^{\infty}n^{-s}
$$

를 유도할 수 있다. 이 식의 좌변을 흔히 zeta 함수 $\zeta(s)$의 오일러 곱 표기라고 부른다.
또한, $n\in\N\setminus{0}$에 대하여 $n^{-s}\geq\int_{n}^{n+1}x^{-s}\,dx$가 성립하므로,

$$
\zeta(s) = \sum_{n=1}^{\infty}n^{-s}\geq \int_{1}^{\infty}x^{-s}\, dx
= \left[\frac{x^{1-s}}{1-s}\right]^{\infty}_{1} = -\frac{1}{1-s}
$$

임을 알 수 있다. 즉, $s\to1+0$일 때, $\zeta(s)\to\infty$이다.
만약 소수가 유한개인 $N$개 존재한다면,
$\lim_{s\to1+0}\prod_{n=1}^{N}\left(1-p_n^{-s}\right)^{-1}$은
발산하지 않을 것이다.
하지만 $\lim_{s\to1+0}\zeta(s)=\lim_{s\to1+0}\sum_{n=1}^{\infty}n^{-s}$가
발산함은 이미 보여졌으므로, 이는 모순이다. 따라서 소수는 무한개 존재한다. □

참고로, Euler 곱 표기를 통하여 $\sum_{n=1}^{\infty}\frac{1}{p_n}$은
발산한다는 것을 보일 수 있다.

**명제**. $\sum_{n=1}^{\infty}\frac{1}{p_n}$은 발산한다.

*증명*. $s>1$에 대해,

$$
\log\prod_{n=1}^N\left(1-p_n^{-s}\right)^{-1}
= -\sum_{n=1}^{\infty}\log\left(1-p_n^{-s}\right)
$$

이고, $p_n^{-s}\leq2^{-s}<2^{-1}$, $0\leq x\leq2^{-1}$에 대해
$-\log(1-x)\leq2x$가 성립하므로,

$$
\log\prod_{n=1}^N\left(1-p_n^{-s}\right)^{-1}
\leq2\sum_{n=1}^{N}p_n^{-s}
\leq2\sum_{n=1}^{\infty}p_n^{-s}
$$

이 때, $\sum_{n=1}^{\infty}p_n^{-s}$은 $\sum_{n=1}^{\infty}n^{-s}$의 부분열이므로
수렴한다. $N\to\infty$일 때,

$$
\log\zeta(s)\leq2\sum_{n=1}^{\infty}p_n^{-s}
$$

이므로, $s\to1+0$일 때 좌항이 발산하므로 우항도 발산한다. □

실제로 $s_n=\sum^{N}_{n=1}{p_n}^{-1}$은 매우 느리게 발산하는 급수이다.
$p$를 소수로 하여 $S(x)=\sum_{p\leq x}p^{-1}$로 두면,
$S(x)\sim\log(\log x)$임이 알려져 있다.

위의 소수의 무한성에 관한 정리에 따르면,
소수는 무한히 존재하므로, 적당한 $n\in\N$을 잡으면, $p\geq n$인 소수 $p$가
항상 존재할 것이다. 그러나 그 소수가 생각한 만큼 가까이에 있으리라는 보장은 없다.

**정리**(소수 사막의 존재). $\forall N\in\N$에 대해, 수열
$\{n\}_{n\in\N}=\{0,1,2,3,\ldots\}$ 중 합성수가 연속하여
$N$번 등장하는 부분(소수 사막)이 존재한다.

*증명*. $2\leq m\leq N+1$인 $m\in\N$에 대해, $m \mid (N+1)!+m$이므로,
$\{n\}_{n\in\N}$의 연속부분열인 $(N+1)!+2, (N+1)!+3, \ldots, (N+1)!+(N+1)$은
길이 $N$의 소수 사막이 된다. □

## 소수 정리

소수를 나열하여 보면, 특별한 규칙을 갖지 않는 듯이 보인다. 소수의 분포에서 규칙성을 찾아 일반화하는 것은,
수학자들의 오랜 과제였다. 여러 수학자들의 노력에 의해, 다음의 정리가 성립하는 것이 밝혀졌다.

**정리**(소수 정리). $x$ 이하의 소수의 개수를 $\pi(x)$라고 할 때,
$\pi(x)\sim\frac{x}{\log(x)}$이다. (단, $\log$는 자연로그이다.)

위 정리는 Gauss에 의해 예상되었으며, Hadamard와 de la Vallée Poussin에 의해 증명되었다.
현대에는 조금 더 오차 값이 적은 $\pi(x)$의 근사함수로
$\text{li}(x)=\int_{0}^{x}\frac{dt}{\log t}$를 많이 사용한다.
$\text{li}(x)\sim\frac{x}{\log x}$ 이므로,
$\pi(x)\sim\text{li}(x)$임을 쉽게 알 수 있다.

## 소수를 판별하는 알고리즘

### $\lfloor\sqrt{n}\rfloor$까지 나누어 보기

### Eratosthenes의 체로 소수 리스트 작성하기

주어진 수의 최대값보다 작은 소수의 리스트를 만들어, 나누어 떨어지도록 하는 소수가 리스트 안에 있는지 확인한다.

### Miller-Rabin 소수 판별법

## 특수한 소수

- $2$: 가장 작은 양의 소수이다.
- ~~$57$: [Grothendieck 소수](https://en.wikipedia.org/wiki/57_(number)#In_mathematics).~~
